<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Annuaire – StopVerifAge</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{background:#0d1b2a;color:#e0e1dd}
    .table{background:#1b263b;color:#e0e1dd}
    .table tr+tr td{border-top:1px solid #415a77}
    .badge.bg-info{background:#415a77!important;color:#e0e1dd!important}
    .badge.bg-warning{background:#778da9!important;color:#0d1b2a!important}
    .form-control,.form-select{background:#1b263b;color:#e0e1dd;border-color:#415a77}
    .btn-light{background:#e0e1dd;color:#0d1b2a;border:0}
  </style>
</head>
<body class="container py-4">
  <h1 class="h4 mb-3">Annuaire des sites</h1>
  <form class="row g-2 mb-4" method="get" action="{{ url_for('sites') }}">
    <div class="col-md-4">
      <input type="text" class="form-control" placeholder="Rechercher…" name="q" value="{{ q or '' }}">
    </div>
    <div class="col-md-3">
      <select class="form-select" name="category">
        <option value="">Catégorie</option>
        {% for cat in categories %}
          <option value="{{ cat }}" {% if selected_category==cat %}selected{% endif %}>{{ cat }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-3">
      <select class="form-select" name="country">
        <option value="">Pays/Région</option>
        {% for c in countries %}
          <option value="{{ c }}" {% if selected_country==c %}selected{% endif %}>{{ c }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-2">
      <button class="btn btn-light w-100">Filtrer</button>
    </div>
  </form>

  <div class="table-responsive">
    <table class="table align-middle">
      <thead>
        <tr>
          <th>Nom</th>
          <th>Tags</th>
          <th>Méthode</th>
          <th>Statut</th>
        </tr>
      </thead>
      <tbody>
      {% for site in sites %}
        <tr>
          <td><a class="link-light" href="{{ url_for('site_detail', site_id=site['id']) }}">{{ site['name'] }}</a></td>
          <td>
            {% for cat in site['categories'] %}<span class="badge bg-info me-1">{{ cat }}</span>{% endfor %}
            {% for cty in site['countries'] %}<span class="badge bg-warning">{{ cty }}</span>{% endfor %}
          </td>
          <td>{{ site['verification_type'] or '—' }}</td>
          <td>{{ site['status'] or '—' }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</body>
</html>
